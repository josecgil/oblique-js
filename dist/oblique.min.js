(function(){this.DirectiveCollection=function(){function DirectiveCollection(){this.directives=[],this._cssExpressions=[]}return DirectiveCollection.prototype.count=function(){return this.directives.length},DirectiveCollection.prototype._isAFunction=function(memberToTest){return"function"==typeof memberToTest},DirectiveCollection.NOT_A_FUNCTION_CLASS_ERROR_MESSAGE="registerDirective must be called with a Directive 'Constructor/Class'",DirectiveCollection.DOESNT_HAVE_PROPERTY_CSS_EXPR_MESSAGE="directive must has an static CSS_EXPRESSION property",DirectiveCollection.prototype._throwErrorIfDirectiveIsNotValid=function(directive){if(!this._isAFunction(directive))throw ObliqueError(DirectiveCollection.NOT_A_FUNCTION_CLASS_ERROR_MESSAGE);if(!directive.CSS_EXPRESSION)throw ObliqueError(DirectiveCollection.DOESNT_HAVE_PROPERTY_CSS_EXPR_MESSAGE)},DirectiveCollection.prototype.add=function(directive){return this._throwErrorIfDirectiveIsNotValid(directive),this.directives.push(directive),this._buildCSSExpressions()},DirectiveCollection.prototype.at=function(index){return this.directives[index]},DirectiveCollection.prototype._containsCssExpr=function(exprToSearch,exprArray){var expr,_i,_len;for(_i=0,_len=exprArray.length;_len>_i;_i++)if(expr=exprArray[_i],exprToSearch===expr)return!0;return!1},DirectiveCollection.prototype._buildCSSExpressions=function(){var cssExpr,directive,_i,_len,_ref,_results;for(this._cssExpressions=[],_ref=this.directives,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)directive=_ref[_i],cssExpr=directive.CSS_EXPRESSION,this._containsCssExpr(cssExpr,this._cssExpressions)||_results.push(this._cssExpressions.push(cssExpr));return _results},DirectiveCollection.prototype.getCSSExpressions=function(){return this._cssExpressions},DirectiveCollection.prototype.getDirectivesByCSSExpression=function(cssExpression){var cssExpr,directive,directivesWithCSSExpr,_i,_len,_ref;for(directivesWithCSSExpr=[],_ref=this.directives,_i=0,_len=_ref.length;_len>_i;_i++)directive=_ref[_i],cssExpr=directive.CSS_EXPRESSION,cssExpr===cssExpression&&directivesWithCSSExpr.push(directive);return directivesWithCSSExpr},DirectiveCollection}()}).call(this),function(){this.Oblique=function(){function Oblique(){return this===window?new Oblique:Oblique._singletonInstance?Oblique._singletonInstance:(Oblique._singletonInstance=this,this._throwErrorIfJQueryIsntLoaded(),this._intervalTimeInMs=Oblique.DEFAULT_INTERVAL_MS,this._lastIntervalId=void 0,this._directiveCollection=new DirectiveCollection,void this._listenToDirectivesInDOM())}return Oblique.DEFAULT_INTERVAL_MS=500,Oblique.prototype._throwErrorIfJQueryIsntLoaded=function(){if(!window.jQuery)throw new ObliqueError("Oblique needs jQuery to work")},Oblique.prototype._clearLastInterval=function(){return void 0!==this._lastIntervalId?clearInterval(this._lastIntervalId):void 0},Oblique.prototype._applyDirectivesOnDocumentReady=function(){return jQuery(document).ready(function(_this){return function(){return _this._applyDirectivesInDOM()}}(this))},Oblique.prototype._setNewInterval=function(){return this._lastIntervalId=setInterval(function(_this){return function(){return _this._applyDirectivesInDOM()}}(this),this._intervalTimeInMs)},Oblique.prototype._listenToDirectivesInDOM=function(){return this._clearLastInterval(),this._applyDirectivesOnDocumentReady(),this._setNewInterval()},Oblique.prototype._mustApplyDirective=function(DOMElement,directive){return new ObliqueDOMElement(DOMElement).matchCSSExpression(directive.CSS_EXPRESSION)},Oblique._isApplyingDirectivesInDOM=!1,Oblique.prototype._applyDirectivesInDOM=function(){var rootElement,rootObElement;if(!this._isApplyingDirectivesInDOM){this._isApplyingDirectivesInDOM=!0;try{return rootElement=document.getElementsByTagName("body")[0],rootObElement=new ObliqueDOMElement(rootElement),rootObElement.eachDescendant(function(_this){return function(DOMElement){var cssExpr,directive,directiveName,obElement,_i,_len,_ref,_results;for(obElement=new ObliqueDOMElement(DOMElement),_ref=_this._directiveCollection.getCSSExpressions(),_results=[],_i=0,_len=_ref.length;_len>_i;_i++)cssExpr=_ref[_i],obElement.matchCSSExpression(cssExpr)&&_results.push(function(){var _j,_len1,_ref1,_results1;for(_ref1=this._directiveCollection.getDirectivesByCSSExpression(cssExpr),_results1=[],_j=0,_len1=_ref1.length;_len1>_j;_j++)directive=_ref1[_j],directiveName=directive.name,obElement.hasFlag(directiveName)||(obElement.setFlag(directiveName),_results1.push(new directive(DOMElement)));return _results1}.call(_this));return _results}}(this))}finally{this._isApplyingDirectivesInDOM=!1}}},Oblique.prototype.getIntervalTimeInMs=function(){return this._intervalTimeInMs},Oblique.prototype.setIntervalTimeInMs=function(newIntervalTimeInMs){if(0>=newIntervalTimeInMs)throw new ObliqueError("IntervalTime must be a positive number");return this._intervalTimeInMs=newIntervalTimeInMs,this._listenToDirectivesInDOM()},Oblique.prototype.registerDirective=function(directiveConstructorFn){return this._directiveCollection.add(directiveConstructorFn)},Oblique.prototype.destroy=function(){var e;this._clearLastInterval();try{return delete Oblique._singletonInstance}catch(_error){return e=_error,Oblique._singletonInstance=void 0}},Oblique}()}.call(this),function(){this.ObliqueDOMElement=function(){function ObliqueDOMElement(DOMElement){this._DOMElement=DOMElement,this._jQueryElement=jQuery(DOMElement)}return ObliqueDOMElement.prototype.isTag=function(){return ObliqueDOMElement._isTag(this._DOMElement)},ObliqueDOMElement.prototype.matchCSSExpression=function(cssExpression){return this._jQueryElement.is(cssExpression)},ObliqueDOMElement.prototype.setFlag=function(flagName){return this._jQueryElement.data(flagName,!0)},ObliqueDOMElement.prototype.unsetFlag=function(flagName){return this._jQueryElement.removeData(flagName)},ObliqueDOMElement.prototype.hasFlag=function(flagName){return this._jQueryElement.data(flagName)},ObliqueDOMElement.prototype.eachDescendant=function(callbackOnDOMElement){return ObliqueDOMElement._traverse(this._DOMElement,callbackOnDOMElement)},ObliqueDOMElement._isTag=function(DOMElement){return 1===DOMElement.nodeType},ObliqueDOMElement._traverse=function(parentElement,callbackOnDOMElement){var child,currentElement,elementsToTraverse,_results;for(elementsToTraverse=[],ObliqueDOMElement._isTag(parentElement)&&elementsToTraverse.push(parentElement),callbackOnDOMElement(parentElement),_results=[];elementsToTraverse.length>0;)currentElement=elementsToTraverse.pop(),_results.push(function(){var _i,_len,_ref,_results1;for(_ref=currentElement.children,_results1=[],_i=0,_len=_ref.length;_len>_i;_i++)child=_ref[_i],ObliqueDOMElement._isTag(child)?(elementsToTraverse.push(child),_results1.push(callbackOnDOMElement(child))):_results1.push(void 0);return _results1}());return _results},ObliqueDOMElement}()}.call(this),function(){this.ObliqueError=function(){function ObliqueError(message){return this.message=message,this.name="ObliqueError",this===window?new ObliqueError(this.message):void 0}return ObliqueError}()}.call(this);