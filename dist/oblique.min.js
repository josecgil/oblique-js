(function(){var DirectiveCollection;this.ObliqueNS=this.ObliqueNS||{},DirectiveCollection=function(){function DirectiveCollection(){this.directives=[],this._cssExpressions=[]}return DirectiveCollection.prototype.count=function(){return this.directives.length},DirectiveCollection.prototype._isAFunction=function(memberToTest){return"function"==typeof memberToTest},DirectiveCollection.NOT_A_FUNCTION_CLASS_ERROR_MESSAGE="registerDirective must be called with a Directive 'Constructor/Class'",DirectiveCollection.DOESNT_HAVE_PROPERTY_CSS_EXPR_MESSAGE="directive must has an static CSS_EXPRESSION property",DirectiveCollection.prototype._throwErrorIfDirectiveIsNotValid=function(directive){if(!this._isAFunction(directive))throw new ObliqueNS.Error(ObliqueNS.DirectiveCollection.NOT_A_FUNCTION_CLASS_ERROR_MESSAGE);if(!directive.CSS_EXPRESSION)throw new ObliqueNS.Error(ObliqueNS.DirectiveCollection.DOESNT_HAVE_PROPERTY_CSS_EXPR_MESSAGE)},DirectiveCollection.prototype.add=function(directive){return this._throwErrorIfDirectiveIsNotValid(directive),this.directives.push(directive),this._buildCSSExpressions()},DirectiveCollection.prototype.at=function(index){return this.directives[index]},DirectiveCollection.prototype._containsCssExpr=function(exprToSearch,exprArray){var expr,_i,_len;for(_i=0,_len=exprArray.length;_len>_i;_i++)if(expr=exprArray[_i],exprToSearch===expr)return!0;return!1},DirectiveCollection.prototype._buildCSSExpressions=function(){var cssExpr,directive,_i,_len,_ref,_results;for(this._cssExpressions=[],_ref=this.directives,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)directive=_ref[_i],cssExpr=directive.CSS_EXPRESSION,this._containsCssExpr(cssExpr,this._cssExpressions)||_results.push(this._cssExpressions.push(cssExpr));return _results},DirectiveCollection.prototype.getCSSExpressions=function(){return this._cssExpressions},DirectiveCollection.prototype.getDirectivesByCSSExpression=function(cssExpression){var cssExpr,directive,directivesWithCSSExpr,_i,_len,_ref;for(directivesWithCSSExpr=[],_ref=this.directives,_i=0,_len=_ref.length;_len>_i;_i++)directive=_ref[_i],cssExpr=directive.CSS_EXPRESSION,cssExpr===cssExpression&&directivesWithCSSExpr.push(directive);return directivesWithCSSExpr},DirectiveCollection}(),ObliqueNS.DirectiveCollection=DirectiveCollection}).call(this),function(){var DirectiveProcessor;this.ObliqueNS=this.ObliqueNS||{},DirectiveProcessor=function(){function DirectiveProcessor(){return this===window?new DirectiveProcessor:DirectiveProcessor._singletonInstance?DirectiveProcessor._singletonInstance:(DirectiveProcessor._singletonInstance=this,this._throwErrorIfJQueryIsntLoaded(),this._intervalTimeInMs=DirectiveProcessor.DEFAULT_INTERVAL_MS,this._lastIntervalId=void 0,this._directiveCollection=new ObliqueNS.DirectiveCollection,void this._listenToDirectivesInDOM())}var Element;return Element=ObliqueNS.Element,DirectiveProcessor.DEFAULT_INTERVAL_MS=500,DirectiveProcessor.prototype._throwErrorIfJQueryIsntLoaded=function(){if(!window.jQuery)throw new Error("DirectiveProcessor needs jQuery to work")},DirectiveProcessor.prototype._clearLastInterval=function(){return void 0!==this._lastIntervalId?clearInterval(this._lastIntervalId):void 0},DirectiveProcessor.prototype._applyDirectivesOnDocumentReady=function(){return jQuery(document).ready(function(_this){return function(){return _this._applyDirectivesInDOM()}}(this))},DirectiveProcessor.prototype._setNewInterval=function(){return this._lastIntervalId=setInterval(function(_this){return function(){return _this._applyDirectivesInDOM()}}(this),this._intervalTimeInMs)},DirectiveProcessor.prototype._listenToDirectivesInDOM=function(){return this._clearLastInterval(),this._applyDirectivesOnDocumentReady(),this._setNewInterval()},DirectiveProcessor._isApplyingDirectivesInDOM=!1,DirectiveProcessor.prototype._applyDirectivesInDOM=function(){var rootElement,rootObElement;if(!this._isApplyingDirectivesInDOM){this._isApplyingDirectivesInDOM=!0;try{return rootElement=document.getElementsByTagName("body")[0],rootObElement=new ObliqueNS.Element(rootElement),rootObElement.eachDescendant(function(_this){return function(DOMElement){var cssExpr,directive,directiveName,obElement,_i,_len,_ref,_results;for(obElement=new ObliqueNS.Element(DOMElement),_ref=_this._directiveCollection.getCSSExpressions(),_results=[],_i=0,_len=_ref.length;_len>_i;_i++)cssExpr=_ref[_i],obElement.matchCSSExpression(cssExpr)&&_results.push(function(){var _j,_len1,_ref1,_results1;for(_ref1=this._directiveCollection.getDirectivesByCSSExpression(cssExpr),_results1=[],_j=0,_len1=_ref1.length;_len1>_j;_j++)directive=_ref1[_j],directiveName=directive.name,obElement.hasFlag(directiveName)||(obElement.setFlag(directiveName),_results1.push(new directive(DOMElement)));return _results1}.call(_this));return _results}}(this))}finally{this._isApplyingDirectivesInDOM=!1}}},DirectiveProcessor.prototype.getIntervalTimeInMs=function(){return this._intervalTimeInMs},DirectiveProcessor.prototype.setIntervalTimeInMs=function(newIntervalTimeInMs){if(0>=newIntervalTimeInMs)throw new ObliqueNS.Error("IntervalTime must be a positive number");return this._intervalTimeInMs=newIntervalTimeInMs,this._listenToDirectivesInDOM()},DirectiveProcessor.prototype.registerDirective=function(directiveConstructorFn){return this._directiveCollection.add(directiveConstructorFn)},DirectiveProcessor.prototype.destroy=function(){var e;this._clearLastInterval();try{return delete DirectiveProcessor._singletonInstance}catch(_error){return e=_error,DirectiveProcessor._singletonInstance=void 0}},DirectiveProcessor}(),ObliqueNS.DirectiveProcessor=DirectiveProcessor,this.Oblique=DirectiveProcessor}.call(this),function(){var Element;this.ObliqueNS=this.ObliqueNS||{},Element=function(){function Element(DOMElement){this._DOMElement=DOMElement,this._jQueryElement=jQuery(DOMElement)}return Element.prototype.isTag=function(){return Element._isTag(this._DOMElement)},Element.prototype.matchCSSExpression=function(cssExpression){return this._jQueryElement.is(cssExpression)},Element.prototype.setFlag=function(flagName){return this._jQueryElement.data(flagName,!0)},Element.prototype.unsetFlag=function(flagName){return this._jQueryElement.removeData(flagName)},Element.prototype.hasFlag=function(flagName){return this._jQueryElement.data(flagName)},Element.prototype.eachDescendant=function(callbackOnDOMElement){return Element._traverse(this._DOMElement,callbackOnDOMElement)},Element._isTag=function(DOMElement){return 1===DOMElement.nodeType},Element._traverse=function(parentElement,callbackOnDOMElement){var child,currentElement,elementsToTraverse,_results;for(elementsToTraverse=[],Element._isTag(parentElement)&&elementsToTraverse.push(parentElement),callbackOnDOMElement(parentElement),_results=[];elementsToTraverse.length>0;)currentElement=elementsToTraverse.pop(),_results.push(function(){var _i,_len,_ref,_results1;for(_ref=currentElement.children,_results1=[],_i=0,_len=_ref.length;_len>_i;_i++)child=_ref[_i],Element._isTag(child)?(elementsToTraverse.push(child),_results1.push(callbackOnDOMElement(child))):_results1.push(void 0);return _results1}());return _results},Element}(),ObliqueNS.Element=Element}.call(this),function(){var Error;this.ObliqueNS=this.ObliqueNS||{},Error=function(){function Error(message){return this.message=message,this.name="Oblique.Error",this===window?new Error(this.message):void 0}return Error}(),ObliqueNS.Error=Error}.call(this),function(){var TimedDOMObserver;this.ObliqueNS=this.ObliqueNS||{},TimedDOMObserver=function(){function TimedDOMObserver(){this._reset(),this._callback=void 0,this._intervalInMs=500}return TimedDOMObserver.prototype.onChange=function(callback){return this._callback=callback},TimedDOMObserver.prototype.setIntervalInMs=function(newIntervalInMs){return this._intervalInMs=newIntervalInMs},TimedDOMObserver.prototype.observe=function(){return this.destroy(),this._callback?this._intervalId=setInterval(function(_this){return function(){return _this._callback()}}(this),this._intervalInMs):void 0},TimedDOMObserver.prototype._reset=function(){return this._intervalId=void 0},TimedDOMObserver.prototype.destroy=function(){return this._intervalId?(clearInterval(this._intervalId),this._reset()):void 0},TimedDOMObserver}(),ObliqueNS.TimedDOMObserver=TimedDOMObserver}.call(this);